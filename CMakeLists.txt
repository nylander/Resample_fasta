cmake_minimum_required(VERSION 3.10)

# Project name and version
project(ResampleFasta VERSION 0.2)

# Set the C standard
set(CMAKE_C_STANDARD 99)
set(CMAKE_C_STANDARD_REQUIRED True)

# Add the executable
add_executable(refast src/resample_fasta.c)

# Set compiler options for optimization and warnings
if(CMAKE_COMPILER_IS_GNUCC OR CMAKE_C_COMPILER_ID MATCHES "Clang")
    target_compile_options(refast PRIVATE -Wall -O3)
endif()

# Installation rules
install(TARGETS refast DESTINATION bin)

# Add a custom target for testing
add_custom_target(test
    COMMAND refast ../data/infile
    DEPENDS refast
    WORKING_DIRECTORY ${CMAKE_BINARY_DIR}
    COMMENT "Running refast on ../data/infile"
)

# Add a custom target to display help message
add_custom_target(show_help
    COMMAND ${CMAKE_COMMAND} -E echo "Available targets:"
    COMMAND ${CMAKE_COMMAND} -E echo "  all       - Build all targets"
    COMMAND ${CMAKE_COMMAND} -E echo "  clean     - Remove all files generated by the build"
    COMMAND ${CMAKE_COMMAND} -E echo "  install   - Install the project"
    COMMAND ${CMAKE_COMMAND} -E echo "  help      - Display this help message"
)
